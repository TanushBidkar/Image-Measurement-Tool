<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Image Measurement Tool</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="app-container">
        <!-- Top Toolbar -->
        <div class="toolbar">
            <div class="toolbar-left">
                <h1>ğŸ“ Professional Measurement Tool</h1>
            </div>
            <div class="toolbar-right">
                <button id="uploadBtn" class="tool-btn">ğŸ“ Upload Image</button>
                <button id="zoomInBtn" class="tool-btn">ğŸ” Zoom In</button>
                <button id="zoomOutBtn" class="tool-btn">ğŸ” Zoom Out</button>
                <button id="resetZoomBtn" class="tool-btn">â†» Reset Zoom</button>
                <span id="zoomLevel">100%</span>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="upload-overlay" id="uploadOverlay">
            <div class="upload-modal">
                <input type="file" id="imageInput" accept="image/*,.pdf" style="display: none;">
                <div class="upload-content">
                    <span class="upload-icon">ğŸ“</span>
                    <h2>Upload Image</h2>
                    <p>Drag & drop files here or click to browse</p>
                    <p><strong>Supported:</strong> JPG, PNG, WebP, PDF (Max 50MB)</p>
                    <button class="upload-btn">Choose File</button>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Side Panel -->
            <div class="side-panel" id="sidePanel">
                <!-- Calibration Section -->
                <div class="panel-section">
                    <h3>ğŸ¯ Calibration</h3>
                    <div class="input-group">
                        <label>Reference Length (feet):</label>
                        <input type="number" id="referenceLength" value="1.0" step="0.1" min="0.1">
                    </div>
                    <button id="setCalibrateBtn" class="btn-primary">Set Reference</button>
                    <button id="confirmCalibrationBtn" class="btn-success" style="display: none;">Confirm Calibration</button>
                    <div class="calibration-status" id="calibrationStatus">Not Calibrated</div>
                </div>

                <!-- Tools Section -->
                <div class="panel-section">
                    <h3>ğŸ› ï¸ Tools</h3>
                    <button id="measureBtn" class="btn-primary">ğŸ“ Measure</button>
                    <button id="toggleMeasurementsBtn" class="btn-success" data-hidden="false">ğŸ‘ï¸ Hide Measurements</button>
                    <button id="toggleSnapBtn" class="btn-success">ğŸ§² Snap: ON</button>
                    <button id="clearAllBtn" class="btn-danger">ğŸ—‘ï¸ Clear All</button>
                    
                    <!-- Snap Settings -->
                    <div class="input-group" style="margin-top: 15px;">
                        <label>Snap Radius: <span id="snapRadiusValue">15px</span></label>
                        <input type="range" id="snapRadius" min="5" max="50" value="15" step="1" style="width: 100%;">
                    </div>
                </div>

                <!-- Legend Detection Section -->
                <div class="panel-section">
                    <h3>ğŸ¨ Legend Detection</h3>
                    <button id="autoDetectBtn" class="btn-primary">ğŸ” Auto-Detect Legends</button>
                    <button id="viewLegendsBtn" class="btn-success">ğŸ“Š View All Legends</button>
                    <button id="viewByGroupBtn" class="btn-primary">ğŸ“Š View by Group</button>
                </div>

                <!-- Legend Groups Display -->
                <div class="panel-section">
                    <h3>ğŸ¨ Legend Groups</h3>
                    <div id="legendGroupsContainer">
                        <p style="color:#95a5a6; font-style:italic; text-align:center;">No legends detected yet</p>
                    </div>
                </div>

                <!-- Measurements List -->
                <div class="panel-section">
                    <h3>ğŸ“Š Measurements</h3>
                    <div class="measurements-container" id="measurementsList">
                        <p class="no-measurements">No measurements yet</p>
                    </div>
                    <div id="totalContainer"></div>
                </div>

                <!-- Undo/Redo Section -->
                <div class="panel-section">
                    <h3>â†¶ History</h3>
                    <div style="display: flex; gap: 10px;">
                        <button id="undoBtn" class="btn-primary" style="flex: 1;">â†¶ Undo</button>
                        <button id="redoBtn" class="btn-primary" style="flex: 1;">â†· Redo</button>
                    </div>
                </div>
            </div>

            <!-- Main Canvas Area -->
            <div class="canvas-container" id="canvasContainer">
                <div class="canvas-wrapper" id="canvasWrapper">
                    <canvas id="imageCanvas"></canvas>
                    <div class="measurement-tooltip" id="measurementTooltip">
                        <span id="tooltipText">Click and drag to measure</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Measurement Item Template -->
        <template id="measurementTemplate">
            <div class="measurement-item">
                <div class="measurement-info">
                    <span class="measurement-label">Measurement #</span>
                    <span class="measurement-value">0.00 ft</span>
                </div>
                <div class="measurement-actions">
                    <button class="edit-btn" title="Edit">âœï¸</button>
                    <button class="delete-btn" title="Delete">ğŸ—‘ï¸</button>
                    <button class="focus-btn" title="Focus">ğŸ¯</button>
                </div>
            </div>
        </template>
    </div>

    <div class="status-bar" id="statusBar">
        <span class="status-message" id="statusMessage"></span>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
